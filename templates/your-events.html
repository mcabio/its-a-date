{% extends 'base.html' %}

{% block title %}It's A Date!{% endblock %}

{% block body %}
    <h1>Your agenda!</h1>

    <div class="d-flex flex-wrap">
        {% set sorted_events_data = events_data|sort(attribute='date') %}
        {% set rendered_months = [] %}

        {% for data in sorted_events_data %}
            {% if data.month not in rendered_months %}
                <div class="mb-2 me-2" data-bs-theme="dark">
                    <a class="btn btn-outline-light"
                       data-bs-toggle="collapse" 
                       href="#multiCollapse{{data.month}}" 
                       role="button" 
                       aria-expanded="false" 
                       aria-controls="multiCollapse{{data.month}}">
                       {{data.month}}
                    </a>
                </div>
                {% set _ = rendered_months.append(data.month) %}
            {% endif %}
            
            <div class="row">
                <div class="col">
                    <div class="collapse multi-collapse" id="multiCollapse{{data.month}}">
                        <div class="card card-body">
                            Event: {{data.title}}<br>
                            Date: {{data.date}}<br>
                            Description: {{data.description}}<br>
                            Start time: {{data.start_time}}<br>
                            End time: {{data.end_time}}<br>
                           
                            <!-- Edit and delete buttons -->
                            <a class="btn btn-outline-info" href="/edit-event/{{ data.event_id }}" role="button">Edit</a>
                            <a class="btn btn-outline-danger" href="/delete-event/{{ data.event_id }}" role="button">Delete</a>
                        </div>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>
{% endblock %}
